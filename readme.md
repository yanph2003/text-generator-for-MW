## Text Generator(python 3) for MW 使用说明

### by Egamad(User:Yanph2003)

#### 一、简介

- 本脚本适用于生成形如格式为```ABBBBB...BC```的文本，其中各个`B`部分内容大致一致，只有一小部分各不相同
- 本脚本的初衷为缓解创建P主投稿作品一览的麻烦，但不是爬虫，不能实现全自动
- 本脚本的**优点**：
  1. 可以快速填写P主作品一览中的封面图链接
  2. 可以自动填写投稿时间，支持中英文格式
  3. 支持sm以外开头的“sm号”
  4. 配合其他批处理工具事半功倍
  5. ……
- 本脚本的**缺点**：
  1. 不能批量填没有规律的东西
  2. **不能联网**
  3. 不能获得作品名称（只能获得作品标题，就是```【歌姫】名字【オリジナル】```这种的东西）
  4. 其他种种限制
  5. 可能存在的其他BUG
  6. ……

#### 二、使用流程

- 如你所见，这是一个半自动脚本，所以有很多需要你手动操作的步骤
- 简略流程如下
  1. 创建```_template_.txt```文件
  2. 创建```_nico_source_.txt```文件，粘贴入P主稿件列表网页（目前只支持这一类网页）的源代码（可以F12复制）（如果有需要）
  3. 创建配合```_template_.txt```文件使用的其他辅助模板文件
  4. 确认无误后运行```main.py```
  5. 从```result.txt```获取生成结果

#### 三、```_template_.txt```文件的使用

- 该文件的基本格式如下

  ```
  [循环前文本]
  ###[循环次数]###
  [批量生成的文本模板]
  ###
  [循环后文本]
  ```

  请注意：

  - [循环前文本] [批量生成的文本模板] 和 [循环后文本] 可以是多行文本
  - [循环次数] 应当是十进制正整数（当然其实你填0我也没意见），并且和前后的###之间**不能有任何空白字符**

- 例如：

  ```
  {{Playlist|
  ###2###
  {{Producer_Song
  |nnd_id = sm11111111
  |条目 = test
  |标题 = 测试
  }}
  ###
  }}
  ```

  将生成

  ```
  {{Playlist|
  {{Producer_Song
  |nnd_id = sm11111111
  |条目 = test
  |标题 = 测试
  }}
  {{Producer_Song
  |nnd_id = sm11111111
  |条目 = test
  |标题 = 测试
  }}
  }}
  ```

- ```_template_.txt```的 [批量生成的文本模板] 中允许使用由**两个```@```包围**的**预设模板**和**自定义模板**

  1. **自定义模板**

     自定义模板应配合辅助模板文件使用，举例如下：

     ```_template_.txt```中内容为

     ```
     {{Playlist|
     ###3###
     {{Producer_Song
     |nnd_id = @sm@
     |条目 = @title@
     |作曲 = 某大佬
     |标题 = {{lj|@title@}}
     |投稿时间 = @tougao_TIME!@
     }}
     ###
     }}
     ```

     注意到其中使用了三个自定义模板，```sm```、```title```和```SaiSei```，其中```title```被调用了两次；为了使自定义模板生效，需要在同文件夹下新建三个同名辅助模板文件```sm.txt```、```title.txt```和```tougao_TIME!.txt```；模板的命名只需保证是合法的文件名即可，但不能是```_NICO_```开头的字符串，它们是预留给预设模板的名字；假设三个文件内容分别如下：

     ```sm.txt```

     ```
     sm11111111
     sm22222222
     ```

     ```title.txt```

     ```
     标题1
     title2
     タイトル3
     ```

     ```tougao_TIME!.txt```

     ```
     2011.1.1
     2022.2.2
     2033.3.3
     2044.4.4
     ```

     则运行```main.py```后生成的```result.txt```如下：

     ```
     {{Playlist|
     {{Producer_Song
     |nnd_id = sm11111111
     |条目 = 标题1
     |作曲 = 某大佬
     |标题 = {{lj|标题1}}
     |投稿时间 = 2011.1.1
     }}
     {{Producer_Song
     |nnd_id = sm22222222
     |条目 = title2
     |作曲 = 某大佬
     |标题 = {{lj|title2}}
     |投稿时间 = 2022.2.2
     }}
     {{Producer_Song
     |nnd_id = sm22222222
     |条目 = タイトル3
     |作曲 = 某大佬
     |标题 = {{lj|タイトル3}}
     |投稿时间 = 2033.3.3
     }}
     }}
     ```

     在本例中，[循环次数] 为3次，注意到辅助模板文件中，文件行数**不足**循环次数的模板将以**最后一行**填充剩余复制，而文件行数**超过**循环次数的模板超过循环次数的部分将被**忽略**

  2. **预设模板**

     预设模板名字以```_NICO_```开头（在```_template_.txt```中仍需两个```@```包裹），目前实现了```_NICO_SM_```、```_NICO_TITLE_```、```_NICO_DATE_```、```_NICO_LENGTH_```和```_NICO_IMG_```五个，分别用于半自动地获取**sm号**、**稿件标题**（<u>注意：是稿件标题，不是作品的名称，会带上诸如```【オリジナル曲】```之类的零碎</u>）、**投稿时间**、**作品长度**以及**作品封面链接**；预设模板须配合**```_nico_source_.txt```**文件使用；在使用这些模板之前，请先访问niconico上目标P主的投稿列表页面，并按**F12**打开开发人员工具，将整个页面代码**```<body>```到```</body>```**的部分直接复制粘贴到```_nico_source_.txt```中，并保存；如过投稿列表有多页，请依次按顺序粘贴到```_nico_source_.txt```；这些预设模板会按照网页上**从上到下**的顺序依次将每一个作品的相应信息填入各次循环中的相应位置

     - 由于```_nico_source_.txt```文件较大，难以在本文档中举例，**不过这个项目中目前存在的```_template_.txt```、```_nico_source_.txt```以及```result.txt```是一个以{{dead|Samfree}}的全部稿件为例创建作品一览半成品的实例，可供参考**

     - 五个预设模板中，```_NICO_DATE_```和```_NICO_LENGTH_```可以带有额外参数
       1. 将```_NICO_LENGTH_```替换为```_NICO_LENGTH_CHN_```可以将时长显示格式由```3:45```改为```3分45秒```
       2. 将```_NICO_DATE_```替换为```_NICO_DATE_CHN_```可以将投稿时间显示格式由```2022.2.2```改为```2022年2月2日```
       3. 将```_NICO_DATE_```替换为```_NICO_DATE_MIN_```可以将时间精确到分，格式为```2022.2.2 22:22```
       4. 对于```_NICO_DATE_```，```_CHN_```和```_MIN_```可以叠用，```_NICO_DATE_CHN_MIN_```或```_NICO_DATE_CHN_MIN_```可以将投稿时间的格式变为```2022年2月2日 22时22分```
     - 请保证**用预设模板获取到的信息数量与设置的循环次数一致**；推荐的做法是在复制网页源代码前查看P主总稿件数量，并填入[循环次数]。

#### 四、注意事项

1. 请确保设备上安装了**python3**

2. 在粘贴P主稿件列表的源代码前，请务必**上下翻动页面，确保所有的元素、尤其是所有的图片加载完成**，否则复制到的内容中将<u>缺少</u>对应信息，导致生成时信息<u>错位</u>

3. 本脚本**没有排序功能**，预设的所有```_NICO_```模板都是按照网页从上到下的顺序进行信息拉取；而niconico的P主稿件列表默认为按时间从近到远排列；如果希望让生成的列表按照时间从早到晚顺序或其他顺序排列，**请在niconico网页上预先选择对应的排序选项，排列好后再复制网页源代码**

4. 再说一遍，```_NICO_TITLE_```获取的是**稿件标题**（例如```初音ミク・鏡音リン「Promise」【オリジナル曲】```），**而非作品名称**（例如```Promise```）

5. **自定义模板的用法可以是**：对着曲目列表把绘师的名字一个个列在文件里，然后调用本脚本，比在复制好的空模板里填一个往下滑两下要省功夫；也可以配合其他批处理脚本使用（比如偏巧有一个脚本能批量爬绘师的名字，就可以爬到一个文件里，然后用自定义模板填进去）

6. 本脚本**并非只能用于在MW上创建作品一览列表**，理论上你可以这么用：

   ```
   [template.txt]
   Samfree的作品：
   ###65###
   @_NICO_TITLE_@
   ###
   就这些了！！！
   ```

   配合恰当的```_nico_source_.txt```可以得到如下```result.txt```：

   ```
   Samfree的作品：
   IA「マインドボイス」【オリジナル曲】
   初音ミク「ギミラブ、ギミキス」【オリジナル曲】
   初音ミク「Walk This Way!」【オリジナルMV】
   【消滅都市】I Miss You Baby【samfree Remix】
   【samfree×柿チョコ】 Drive into you 【COPEN 「XPLAYミュージック」 第2弾】
   「daze」歌ってみましてん【samfree】
   結月ゆかり「ユカユカ☆ヘヴンリーナイト」【オリジナル曲】
   「ゾラミク★エキセントリックフューチャーナイト」【オリジナルMV】
   初音ミク「New Worlds God」【オリジナル曲】
   IA「イアイア★ナイトオブデザイア」【オリジナル曲】
   【ボーマス17】「Fever」デモ【samfree】
   鏡音リン「侵略」【オリジナル曲】
   初音ミク「Euthanasia」【オリジナル曲】
   「組曲『ニコニコ動画』改」歌ってみた【samfree】
   「キリトリセン」歌ってみた【samfree】
   歌手音ピコ「ピコピコ☆レジェンドオブザナイト」【オリジナル曲】
   歌手音ピコ「トキ☆メキ桃色ハート」【公式デモ】
   歌手音ピコ「闇色アリス」【公式デモ】
   猫村いろは「ネコネコ☆スーパーフィーバーナイト」【オリジナル曲】
   「リリリリ★バーニングナイト」歌ってみた【samfree】
   Lily「リリリリ★バーニングナイト」【オリジナル曲】
   「Crime」クロスフェード【C78】
   巡音ルカ・鏡音レン「Perfect Crime」【オリジナル曲】
   「AGAINST」歌ってみた【samfree】
   【ヤスオ×cosMo×samfree】「いみてーちょろ～ん☆ぶらっく」歌ってみた
   実谷ナナ「ナナナナ★フィーバーミラクルトゥナイト」【オリジナル曲】
   鏡音リン「Fate of Soul～ピリオドの向こうの闇～」【オリジナル曲】
   「アルビノ」歌ってみた【samfree】
   「Last Night, Good Night」歌ってみた【samfree】
   miki「ミキミキ★ロマンティックナイト」【オリジナル曲】
   巡音ルカ「Gravity=Reality」【オリジナル曲】
   鏡音リン「Bye-Bye」【オリジナル曲】
   初音ミク「Prism Heart」【オリジナル曲】
   【samfree】「magnet」歌ってみた【cosMo】
   「Just Be Friends」歌ってみた【samfree】
   初音ミク「Rainbow」【オリジナル曲】
   「パンツレスラーズ！ＥＸ 」歌ってみた【samfree】
   メグッポイド「メグメグ☆ファイアーエンドレスナイト」【オリジナル】
   初音ミク「桜舞う　今」【オリジナル曲】
   初音ミク「闇色アリス」【オリジナル曲】
   巡音ルカ「たこルカ★マグロフィーバー」
   巡音ルカ「ルカルカ★ナイトフィーバー」【オリジナル曲】
   巡音ルカ「Bye-Bye Lover」【オリジナル曲】
   鏡音リン「えもラブ」
   初音ミク「赤い実はじけた」【オリジナル曲】
   初音ミク「キミノモトヘ」【オリジナル曲】
   初音ミク「HAPPY SUNDAY」【オリジナル曲】
   初音ミク「世界で一番近くに居るのに」【オリジナル曲】
   初音ミク「Missing」【オリジナル曲】
   初音ミク「うぉーあいにーだよッ！お兄ちゃん☆」
   【DTM板】初音ミク「こどものじかん」【萌え・電波ソングを作るスレ】
   【DTM板】初音ミク「はじめてのおとまり」【萌え電波ソングを作るスレ】
   鏡音リンで「桜のような恋でした」
   初音ミク「Powder Snow」【オリジナル曲】
   初音ミク「トキメキはぴねす☆」【オリジナル曲】
   鏡音リン「トキメキはぴねす☆」【オリジナル曲】
   初音ミク・鏡音リン「Promise」【オリジナル曲】
   鏡音レン「Daybreak」【オリジナル曲】
   鏡音リン「Daybreak」【オリジナル曲】
   初音ミクがメタル曲「CHAIN」を歌ってくれました
   初音ミク「君のメロディー」【オリジナル曲】
   初音ミク「桜のような恋でした」【オリジナル曲】
   初音ミク「Daybreak  -Full ver-」【オリジナル曲】
   初音ミク「Tender Wind」【オリジナル曲】
   初音ミク「Daybreak」【オリジナル曲】
   就这些了！！！
   ```

#### 五、其他事项

- 如发现BUG或者有无法理解的地方，请尽量以可能的方式通知/询问```Egamad(User:Yanph2003)```
- 对其他功能的需求也可以提出，我会尽量做
- **非常支持自己魔改代码来实现我没写的功能，如果有什么高级的功能**（比如能联网的全自动爬虫，以及怎么把稿件标题变成作品名称，给定稿件标题几乎没有显式规律）**能教教我怎么写就更好了（x**

#### 六、免责声明

#### 	本项目就真只是一个没有技术含量的傻蛋脚本而已，如果实在太难用太屑也莫得办法，我(Egamad)不负任何责任（（（



